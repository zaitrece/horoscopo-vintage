<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Horóscopo Vintage</title>

<!-- Fuente opcional retro; puedes quitar esta línea si quieres -->
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;800&display=swap" rel="stylesheet">

<!-- Tu hoja de estilos externa -->
<link rel="stylesheet" href="styles.css?v=2">
</head>
<body>
<header>
  <h1>Horóscopo Vintage</h1>
  <div class="muted">Old school vibes · Actualizado a diario</div>
</header>

<main>
  <section class="card">
    <label for="signo">Tu signo</label>
    <div class="row" style="align-items:end;grid-template-columns:1fr 180px;">
      <select id="signo">
        <option>Aries</option><option>Tauro</option><option>Géminis</option>
        <option>Cáncer</option><option>Leo</option><option>Virgo</option>
        <option>Libra</option><option>Escorpio</option><option>Sagitario</option>
        <option>Capricornio</option><option>Acuario</option><option>Piscis</option>
      </select>
      <button id="ver">Ver horóscopo</button>
    </div>
  </section>

  <section class="card">
    <div class="sign-head">
      <div class="sign-ico" id="ico">♈︎</div>
      <div>
        <div class="badge" id="badge">ARIES</div>
        <div class="muted" id="fecha">—</div>
      </div>
    </div>
  </section>

  <section class="card">
    <div class="big" id="desc">Elige tu signo y pulsa “Ver horóscopo”.</div>
    <div class="hr-ornamental"></div>
    <div class="muted" id="extra" style="margin-top:10px"></div>
  </section>

  <section class="row">
    <div class="card"><div class="kv"><b>Compatibilidad</b><span id="compat">—</span></div></div>
    <div class="card"><div class="kv"><b>Humor</b><span id="mood">—</span></div></div>
    <div class="card"><div class="kv"><b>Color</b><span id="color">—</span></div></div>
  </section>
</main>

<footer class="footer">© <span id="y"></span> Horóscopo Vintage</footer>

<script>
document.getElementById("y") && (document.getElementById("y").textContent = new Date().getFullYear());

const MAP = {
  "Aries":"aries","Tauro":"taurus","Géminis":"gemini","Cáncer":"cancer","Leo":"leo","Virgo":"virgo",
  "Libra":"libra","Escorpio":"scorpio","Sagitario":"sagittarius","Capricornio":"capricorn",
  "Acuario":"aquarius","Piscis":"pisces"
};
const ICON = {aries:"♈︎",taurus:"♉︎",gemini:"♊︎",cancer:"♋︎",leo:"♌︎",virgo:"♍︎",libra:"♎︎",scorpio:"♏︎",sagittarius:"♐︎",capricorn:"♑︎",aquarius:"♒︎",pisces:"♓︎"};

const DEMO_BY_SIGN = {
  aries:"Impulso para empezar y cerrar pendientes.",
  taurus:"Día para avanzar con calma y constancia.",
  gemini:"Conversaciones que abren puertas y opciones.",
  cancer:"Cuida tus límites y tu descanso.",
  leo:"Brillas si compartes tu talento con otros.",
  virgo:"Ordena tus ideas y simplifica tareas.",
  libra:"Equilibra responsabilidades y vida personal.",
  scorpio:"Intuición alta; observa antes de actuar.",
  sagittarius:"Movimiento y aprendizaje; planifica avances.",
  capricorn:"Progreso firme; reconoce tus logros.",
  aquarius:"Ideas originales; colabora con tu gente.",
  pisces:"Escucha tu intuición y pon límites sanos."
};
const TIP = {
  aries:"Consejo: prioriza 3 tareas y celebra cada avance.",
  taurus:"Consejo: evita sobrecargarte; divide en pasos simples.",
  gemini:"Consejo: toma notas de las ideas que surjan hoy.",
  cancer:"Consejo: dedica un rato a tu autocuidado.",
  leo:"Consejo: comparte tu plan con alguien de confianza.",
  virgo:"Consejo: usa listas cortas y elimina lo accesorio.",
  libra:"Consejo: di no a lo que te desequilibra.",
  scorpio:"Consejo: confía en tu olfato, pero verifica datos.",
  sagittarius:"Consejo: aprende algo breve que te motive.",
  capricorn:"Consejo: revisa metas y ajusta el calendario.",
  aquarius:"Consejo: prueba un enfoque diferente.",
  pisces:"Consejo: protege tu paz y tu tiempo."
};

document.getElementById("ver")?.addEventListener("click", cargar);

function setIconFor(key){
  const el = document.getElementById("icoImg");
  if(!el) return;
  // elimina fallback si existiera
  const sib = el.nextElementSibling;
  if (sib && sib.dataset && sib.dataset.fallback === "1") sib.remove();

  el.style.display = "block";
  el.removeAttribute("src"); // evita parpadeos
  el.src = `img/zodiac/${key}.png?v=${Date.now()}`;

  // fallback si no existe el PNG
  el.onerror = () => {
    el.style.display = "none";
    const fb = document.createElement("div");
    fb.dataset.fallback = "1";
    fb.style.cssText = "font-size:28px;display:grid;place-items:center;width:100%;height:100%";
    fb.textContent = ICON[key] || "★";
    el.after(fb);
  };
}

async function cargar(){
  const signoES = document.getElementById("signo").value;
  const key = MAP[signoES];

  // Icono
  setIconFor(key);

  // UI init
  setText("badge", signoES.toUpperCase());
  setText("fecha", "Cargando…");
  setText("desc", "Cargando…");
  setText("extra", "");
  setText("compat", "—");
  setText("mood", "—");
  setText("color", "—");

  try{
    const r = await fetch(`data/latest.json?v=${Date.now()}`, {cache:"no-store"});
    const ok = r.ok;
    const all = ok ? await r.json() : {};
    const d = (all && all[key]) ? all[key] : {};

    const date = val(d.current_date, fechaHoy());
    const desc = val(d.description, DEMO_BY_SIGN[key]);
    const comp = val(d.compatibility, "No disponible");
    const mood = val(d.mood, "No disponible");
    const color = val(d.color, "No disponible");

    setText("fecha", date);
    setText("desc", `${desc}\n\n${TIP[key]}`);
    setText("compat", comp);
    setText("mood", mood);
    setText("color", color);
  }catch(e){
    setText("fecha", fechaHoy());
    setText("desc", `${DEMO_BY_SIGN[key]}\n\n${TIP[key]}`);
  }
}

// helpers
function setText(id, t){ const el=document.getElementById(id); if(el) el.textContent=t; }
function val(v, fb){ return (v && String(v).trim().length>0) ? v : fb; }
function fechaHoy(){ return new Date().toLocaleDateString("es-ES"); }
</script>

</body>
</html>



